<!DOCTYPE html>
<html lang="es" data-theme="dark">

<head>
  <meta charset="UTF-8">
  <meta name="viewport"
    content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
  <meta name="theme-color" content="#050709">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <title>Admin Panel - Padeluminatis</title>
  <link rel="icon" type="image/x-icon" href="./imagenes/Logojafs.png">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link
    href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&family=Rajdhani:wght@600;700;800;900&display=swap"
    rel="stylesheet">
  <link rel="stylesheet" href="./css/design-system-v3.css">
  <link rel="stylesheet" href="./css/app.css">
  <link rel="stylesheet" href="./css/admin.css">
  <link rel="stylesheet" href="./css/bottom-nav.css">
  <link rel="stylesheet" href="./css/match-modal-v2.css">
</head>

<body class="admin-page"
  style="margin:0; padding:0; font-family:'Inter',sans-serif; background:#050709; color:#fff; min-height:100vh;">

  <!-- Admin Header -->
  <header class="admin-header">
    <div class="admin-header-title">
      <img src="./imagenes/Logojafs.png" alt="Logo">
      <h1>ADMIN<span>.</span>PANEL</h1>
    </div>
    <div style="display:flex; gap:10px;">
      <a href="home.html"
        style="width:38px; height:38px; display:flex; align-items:center; justify-content:center; background:rgba(255,255,255,0.05); border:1px solid rgba(255,255,255,0.1); border-radius:10px; color:#fff; text-decoration:none;">
        <i class="fas fa-home"></i>
      </a>
    </div>
  </header>

  <main style="padding:16px; padding-bottom:100px;">

    <!-- Stats Dashboard -->
    <div class="admin-stats-grid">
      <div class="admin-stat-card users">
        <i class="fas fa-users"></i>
        <div class="admin-stat-number" id="count-users">0</div>
        <div class="admin-stat-label">Usuarios</div>
      </div>
      <div class="admin-stat-card matches">
        <i class="fas fa-calendar-alt"></i>
        <div class="admin-stat-number" id="count-matches">0</div>
        <div class="admin-stat-label">Reservas</div>
      </div>
      <div class="admin-stat-card pending">
        <i class="fas fa-hourglass-half"></i>
        <div class="admin-stat-number" id="count-pending">0</div>
        <div class="admin-stat-label">Pendientes</div>
      </div>
      <div class="admin-stat-card played">
        <i class="fas fa-check-double"></i>
        <div class="admin-stat-number" id="count-played">0</div>
        <div class="admin-stat-label">Jugados</div>
      </div>
    </div>

    <!-- Tabs -->
    <div class="admin-tabs">
      <button class="admin-tab active" data-tab="users">
        <i class="fas fa-users"></i> Usuarios
      </button>
      <button class="admin-tab" data-tab="matches">
        <i class="fas fa-table-tennis-paddle-ball"></i> Partidos
      </button>
      <button class="admin-tab" data-tab="ranking">
        <i class="fas fa-trophy"></i> Ranking
      </button>
    </div>

    <!-- SECTION: Users Management -->
    <section id="section-users" class="admin-section active">
      <div class="admin-card">
        <div class="admin-card-header">
          <div class="admin-card-title">
            <i class="fas fa-users-cog"></i> Gestión de Usuarios
          </div>
          <button class="admin-btn-icon" onclick="refreshUsers()" title="Refrescar">
            <i class="fas fa-sync-alt"></i>
          </button>
        </div>
        <div class="admin-card-body">
          <div class="admin-search">
            <i class="fas fa-search"></i>
            <input type="text" id="search-users" placeholder="Buscar usuario..." oninput="filterUsers(this.value)">
          </div>
          <div id="users-list" style="max-height:400px; overflow-y:auto;">
            <div class="admin-empty">
              <i class="fas fa-spinner fa-spin"></i>
              <p>Cargando usuarios...</p>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- SECTION: Matches Management -->
    <section id="section-matches" class="admin-section">
      <div class="admin-card">
        <div class="admin-card-header">
          <div class="admin-card-title">
            <i class="fas fa-table-tennis-paddle-ball"></i> Gestión de Partidos
          </div>
          <div style="display:flex; gap:6px;">
            <button class="admin-btn-icon" onclick="refreshMatches()" title="Refrescar">
              <i class="fas fa-sync-alt"></i>
            </button>
          </div>
        </div>
        <div class="admin-card-body">
          <div class="admin-search">
            <i class="fas fa-search"></i>
            <input type="text" id="search-matches" placeholder="Buscar por fecha o jugador...">
          </div>

          <!-- Filter Chips -->
          <div style="display:flex; gap:6px; margin-bottom:12px; flex-wrap:wrap;">
            <button class="admin-tab active" style="flex:0; padding:8px 14px; font-size:0.65rem;"
              data-filter="all">TODOS</button>
            <button class="admin-tab" style="flex:0; padding:8px 14px; font-size:0.65rem;"
              data-filter="pending">PENDIENTES</button>
            <button class="admin-tab" style="flex:0; padding:8px 14px; font-size:0.65rem;"
              data-filter="played">JUGADOS</button>
          </div>

          <div id="matches-list" style="max-height:400px; overflow-y:auto;">
            <div class="admin-empty">
              <i class="fas fa-spinner fa-spin"></i>
              <p>Cargando partidos...</p>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- SECTION: Ranking Management -->
    <section id="section-ranking" class="admin-section">
      <div class="admin-card">
        <div class="admin-card-header">
          <div class="admin-card-title">
            <i class="fas fa-trophy"></i> Control de Ranking
          </div>
          <button class="admin-btn-icon" onclick="recalculateRanking()" title="Recalcular Todo">
            <i class="fas fa-calculator"></i>
          </button>
        </div>
        <div class="admin-card-body">
          <p style="font-size:0.8rem; color:rgba(255,255,255,0.5); margin-bottom:16px;">
            Modifica puntos, niveles y estadísticas de cualquier jugador.
          </p>
          <div id="ranking-admin-list" style="max-height:400px; overflow-y:auto;">
            <div class="admin-empty">
              <i class="fas fa-spinner fa-spin"></i>
              <p>Cargando ranking...</p>
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <!-- Edit User Modal -->
  <div class="admin-modal-overlay" id="modal-edit-user">
    <div class="admin-modal">
      <div class="admin-modal-header">
        <div class="admin-modal-title">
          <i class="fas fa-user-edit"></i> Editar Usuario
        </div>
        <button class="admin-modal-close" onclick="closeModal('modal-edit-user')">×</button>
      </div>
      <div class="admin-modal-body">
        <input type="hidden" id="edit-user-id">
        <div class="admin-form-group">
          <label class="admin-form-label">Nombre</label>
          <input type="text" class="admin-form-input" id="edit-user-name" placeholder="Nombre del jugador">
        </div>
        <div class="admin-form-row">
          <div class="admin-form-group">
            <label class="admin-form-label">Nivel</label>
            <input type="number" step="0.01" min="2" max="5" class="admin-form-input" id="edit-user-level"
              placeholder="2.50">
          </div>
          <div class="admin-form-group">
            <label class="admin-form-label">Puntos Ranking</label>
            <input type="number" class="admin-form-input" id="edit-user-points" placeholder="0">
          </div>
        </div>
        <div class="admin-form-row">
          <div class="admin-form-group">
            <label class="admin-form-label">Family Points</label>
            <input type="number" class="admin-form-input" id="edit-user-fp" placeholder="100">
          </div>
          <div class="admin-form-group">
            <label class="admin-form-label">Partidos Jugados</label>
            <input type="number" class="admin-form-input" id="edit-user-matches" placeholder="0">
          </div>
        </div>
        <div class="admin-form-group">
          <label class="admin-form-label">Es Admin</label>
          <select class="admin-form-input admin-form-select" id="edit-user-admin">
            <option value="false">No</option>
            <option value="true">Sí</option>
          </select>
        </div>
      </div>
      <div class="admin-modal-footer">
        <button class="admin-btn admin-btn-ghost" onclick="closeModal('modal-edit-user')">Cancelar</button>
        <button class="admin-btn admin-btn-primary" onclick="saveUserChanges()">
          <i class="fas fa-save"></i> Guardar
        </button>
      </div>
    </div>
  </div>

  <!-- Edit Match Modal -->
  <div class="admin-modal-overlay" id="modal-edit-match">
    <div class="admin-modal">
      <div class="admin-modal-header">
        <div class="admin-modal-title">
          <i class="fas fa-edit"></i> Editar Partido
        </div>
        <button class="admin-modal-close" onclick="closeModal('modal-edit-match')">×</button>
      </div>
      <div class="admin-modal-body">
        <input type="hidden" id="edit-match-id">
        <input type="hidden" id="edit-match-collection">

        <div class="admin-form-group">
          <label class="admin-form-label">Estado</label>
          <select class="admin-form-input admin-form-select" id="edit-match-status">
            <option value="abierto">Abierto</option>
            <option value="cerrado">Cerrado</option>
            <option value="jugado">Jugado</option>
            <option value="anulado">Anulado</option>
          </select>
        </div>

        <div class="admin-form-group">
          <label class="admin-form-label">Resultado (ej: 6-4, 7-5)</label>
          <input type="text" class="admin-form-input" id="edit-match-result" placeholder="6-4, 6-3">
        </div>

        <div class="admin-form-group">
          <label class="admin-form-label">Equipo Ganador</label>
          <select class="admin-form-input admin-form-select" id="edit-match-winner">
            <option value="">Sin definir</option>
            <option value="1">Equipo 1 (Pos 1-2)</option>
            <option value="2">Equipo 2 (Pos 3-4)</option>
          </select>
        </div>

        <div
          style="background:rgba(0,229,255,0.05); border:1px solid rgba(0,229,255,0.15); border-radius:10px; padding:12px; margin-top:16px;">
          <div
            style="font-size:0.7rem; font-weight:700; color:var(--admin-accent); margin-bottom:8px; text-transform:uppercase;">
            Jugadores</div>
          <div id="edit-match-players" style="font-size:0.8rem; color:rgba(255,255,255,0.7);">
            Cargando...
          </div>
        </div>
      </div>
      <div class="admin-modal-footer">
        <button class="admin-btn admin-btn-ghost" onclick="closeModal('modal-edit-match')">Cancelar</button>
        <button class="admin-btn admin-btn-primary" onclick="saveMatchChanges()">
          <i class="fas fa-save"></i> Guardar
        </button>
      </div>
    </div>
  </div>

  <!-- Bottom Navigation -->
  <nav class="bottom-nav">
    <a href="home.html" class="nav-link">
      <i class="fas fa-home"></i>
      <span>INICIO</span>
    </a>
    <a href="calendario.html" class="nav-link">
      <i class="fas fa-calendar-alt"></i>
      <span>RESERVAS</span>
    </a>
    <a href="puntosRanking.html" class="nav-fab">
      <i class="fas fa-trophy"></i>
    </a>
    <a href="eventos.html" class="nav-link">
      <i class="fas fa-bolt"></i>
      <span>EVENTOS</span>
    </a>
    <a href="partidos.html" class="nav-link">
      <i class="fas fa-table-tennis-paddle-ball"></i>
      <span>PARTIDOS</span>
    </a>
  </nav>

  <script type="module" src="./js/admin-panel.js"></script>
</body>

</html>